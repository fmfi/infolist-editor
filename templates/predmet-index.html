{% extends 'layout.html' %}
{% from 'macros.html' import flashes %}
{% block title %}Predmety a informačné listy{% endblock %}
{% block content %}
<div class="content-100">
  {{ flashes() }}
  <h1>Zoznam predmetov a informačných listov</h1>
  <ul class="nav nav-tabs">
    <li class="{{ 'active' if tab == 'moje' else '' }}"><a href="{{ url_for('predmet_index', tab='moje') }}">Moje</a></li>
    <li class="{{ 'active' if tab == 'moje-upravy' else '' }}"><a href="{{ url_for('predmet_index', tab='moje-upravy') }}">Moje úpravy</a></li>
    <li class="{{ 'active' if tab == 'vyucujem' else '' }}"><a href="{{ url_for('predmet_index', tab='vyucujem') }}">Vyučujem</a></li>
    <li class="{{ 'active' if tab == 'oblubene' else '' }}"><a href="{{ url_for('predmet_index', tab='oblubene') }}">Obľúbené</a></li>
    <li class="{{ 'active' if tab == 'vsetky' else '' }}"><a href="{{ url_for('predmet_index', tab='vsetky') }}">Všetky</a></li>
  </ul>
  {% if tab == 'moje' %}
    <p class="help-block">Táto záložka zobrazuje predmety, v ktorých ste buď vytvorili alebo upravili nejaký informačný list,
       alebo ste v nejakom informačnom liste uvedení ako vyučujúci alebo ste označili predmet ako obľúbený</p>
  {% elif tab == 'moje-upravy' %}
    <p class="help-block">Táto záložka zobrazuje predmety, v ktorých ste vytvorili alebo upravili nejaký informačný list</p>
  {% elif tab == 'vyucujem' %}
    <p class="help-block">Táto záložka zobrazuje predmety, v ktorých ste v nejakom informačnom liste uvedení ako vyučujúci</p>
  {% endif %}
  <div class="filter">
    <form method="GET">
      {% macro filter_field(name, label) %}
        <span class="filter-field">
        <label for="{{ name }}">{{ label }}</label>
        <select id="{{ name }}" name="{{ name }}" style="width: 7em;">
          <option value="vsetky" {% if filtruj[name] == None %}selected="selected"{% endif %}>Všetky</option>
          <option value="ano" {% if filtruj[name] == True %}selected="selected"{% endif %}>Áno</option>
          <option value="nie" {% if filtruj[name] == False %}selected="selected"{% endif %}>Nie</option>
        </select>
        </span>
      {% endmacro %}
      {{ filter_field('import_z_aisu', 'Import z AIS-u') }}
      {{ filter_field('zamknute', 'Uzamknuté') }}
      {{ filter_field('obsahuje_varovania', 'Obsahuje varovania') }}
      {{ filter_field('finalna_verzia', 'Finálna verzia') }}
      <button type="submit" class="btn btn-default">Filtruj</button>
    </form>
  </div>
  <hr />
  <ul class="predmety">
  {% for predmet in predmety %}
    <li><div title="{{ predmet.kod_predmetu }}" class="clearfix">{{ predmet.skratka }}
          <span class="pull-right">
            {% if not predmet.oblubeny %}
            <form method="POST" action="{{ url_for('predmet_watch', predmet_id=predmet.id) }}"><button class="btn btn-default btn-xs">Pridať do obľúbených</button></form>
            {% else %}
            <form method="POST" action="{{ url_for('predmet_unwatch', predmet_id=predmet.id) }}"><button class="btn btn-default btn-xs">Odstrániť z obľúbených</button></form>
            {% endif %}
          </span>
        </div>
      <ul>
        {% for infolist in predmet.infolisty %}
          <li><a href="{{ url_for('show_infolist', id=infolist.id, edit=False) }}">{{ infolist.nazov_predmetu }}</a>
            <ul class="inline-label">
              {% if infolist.finalna_verzia %}
              <li class="finalna-verzia">finálna verzia</li>
              {% endif %}
              {% if infolist.obsahuje_varovania %}
              <li class="obsahuje-varovania">obsahuje varovania</li>
              {% endif %}
              {% if infolist.import_z_aisu %}
                <li class="import-z-aisu">import z AIS-u</li>
              {% elif infolist.zamknute %}
                <li class="uzamknute">uzamknuté{% if infolist.zamkol %} ({{ (infolist.zamkol|osoba).cele_meno|space2nbsp }}){% endif %}</li>
              {% endif %}
              {% if infolist.vytvoril %}
                <li class="vytvoril">vytvoril: {{ infolist.vytvoril_cele_meno }}</li>
              {% endif %}
              <li class="posledna-zmena">posledná zmena: {{ infolist.modifikovane|datetime(iba_datum=infolist.import_z_aisu)|space2nbsp }}</li>
            </ul>
          </li>
        {% endfor %}
      </ul>
    </li>
  {% endfor %}
  
  <p>
  <a href="{{ url_for('show_infolist', id=None, predmet_id=None, edit=True) }}"
    class="btn btn-primary">Vytvoriť úplne nový predmet</a>
  </p>
  <p>Predmet, ktorý je logickým pokračovateľom (modifikáciou) existujúceho
  predmetu <b>musíte vytvoriť pomocou kópie tohto predmetu.</b> Dôvodom
  je automatické prenášanie štatistík do nových informačných listov.</p>

  <p>Úplne nové predmety <b>nevytvárajte ako kópie existujúcich
  predmetov</b> (aby sa nepreniesli neželané štatistiky z pôvodného
  predmetu).</p>
  
</div>
{% endblock %}
