{% extends 'studprog.html' %}
{% block studprog %}
<div class="body">
  {% if prilohy %}
    {% for typ_prilohy, subory in prilohy %}
      <h4>{{ typ_prilohy.nazov }}{% if typ_prilohy.kriterium %} ({{ typ_prilohy.kriterium }}){% endif %}</h4>
      {% if typ_prilohy.id in [1, 2] %}
        <p>Prílohy v tejto kategórii budú priložené systémom automaticky.</p>
      {% endif %}
      {% if subory %}
      <table class="table">
        <thead>
          <tr>
            <th>Dokument</th>
            <th>Názov súboru</th>
            <th>Čas zmeny</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
        {% for filename, subor in subory %}
          <tr>
            <td><a href="{{ url_for('studijny_program_priloha_stiahni', id=studprog_id, subor=filename) }}">{{ subor.nazov }}</a></td>
            <td>{{  filename }}</td>
            <td>{{ subor.modifikovane|datetime }}</td>
            {% if subor.url_aktualizacie %}
            <td><a class="btn btn-xs btn-default" href="{{ subor.url_aktualizacie }}">Aktualizovať</a></td>
            {% else %}
            <td></td>
            {% endif %}
          </tr>
        {% endfor %}
        </tbody>
      </table>
      {% elif typ_prilohy.id not in [1, 2]  %}
        <p>Žiaden priložený dokument.</p>
      {% endif %}
    {% endfor %}
  {% else %}
    <p>K tomuto študijnému programu nie sú priložené žiadne dokumenty</p>
  {% endif %}
  <a class="btn btn-primary" href="{{ url_for('studijny_program_prilohy_upload', studprog_id=studprog_id) }}">Pridať dokument</a>
  <a class="btn btn-default" href="{{ url_for('studijny_program_priloha_stiahni_zip', id=studprog_id) }}"><span class="glyphicon glyphicon-download"></span> Stiahnuť všetky prílohy</a>
  <hr />
  <table class="table">
    <thead>
      <tr>
        <th>Typ prílohy</th>
        <th>Počet</th>
      </tr>
    </thead>
    <tbody>
      {% for typ_prilohy, subory in prilohy if typ_prilohy.id != 0 %}
      <tr>
        <td>{{ typ_prilohy.nazov }}</td>
        <td>{{ subory|count }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}